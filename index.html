<!DOCTYPE html>
<html>
<head>
    <title>IP Enforcement Options</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Montserrat', sans-serif;
            background: #1D252C;
            color: #E5E8EC;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: auto;
        }
        .welcome-screen {
            min-height: 80vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 20px;
        }
        .welcome-content {
            max-width: 800px;
        }
        .welcome-text {
            color: #E5E8EC;
            opacity: 0.9;
            line-height: 1.6;
            margin: 2rem auto;
            font-size: 1.1rem;
        }
        h1 {
            color: #30AEB6;
            font-size: 2.5rem;
            margin-bottom: 1.5rem;
        }
        .question-box {
            background: #313d48;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .option-button {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background: #E5E8EC;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            text-align: left;
            font-size: 16px;
            transition: background-color 0.2s;
        }
        .option-button:hover {
            background: #d1d5d9;
        }
        .option-button.selected {
            background: #30AEB6;
            color: white;
        }
        .explanation {
            background: #3d4957;
            color: #84C98F;
            margin: 10px 0 20px 0;
            padding: 15px;
            border-radius: 4px;
            display: none;
            font-size: 14px;
        }
        .progress-bar {
            background: #313d48;
            height: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .progress {
            background: #30AEB6;
            height: 100%;
            border-radius: 5px;
            transition: width 0.3s;
        }
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        .button, .nav-button {
            background: #30AEB6;
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: opacity 0.2s;
        }
        .button:hover, .nav-button:hover {
            opacity: 0.9;
        }
        .nav-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .results-container {
            background: #313d48;
            padding: 30px;
            border-radius: 12px;
            margin-top: 20px;
        }
        .results-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .result-card {
            background: #E5E8EC;
            color: #1D252C;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.2s;
            display: flex;
            flex-direction: column;
        }
        .result-card:hover {
            transform: translateY(-2px);
        }
        .result-card.not-applicable {
            opacity: 0.5;
            background: #9DA3A8;
        }
        .toggle-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .toggle-button {
            background: #30AEB6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            transition: opacity 0.2s;
            font-weight: 500;
        }
        .toggle-button:hover {
            opacity: 0.9;
        }
        .results-subtext {
            color: #E5E8EC;
            opacity: 0.8;
            margin-bottom: 2rem;
            font-size: 10px;
        }
        .option-subtext {
            color: #E5E8EC;
            opacity: 0.8;
            margin-top: -0.5rem;
            margin-bottom: 1rem;
        }
        .option-title {
            font-weight: 600;
            margin-bottom: 1rem;
        }
        .option-details {
            background: rgba(0,0,0,0.05);
            padding: 1rem;
            border-radius: 4px;
            margin: 0.5rem 0;
            font-size: 0.8rem;
                  
        }
        .detail-item {
            margin: 0.25rem 0;
            font-size: 0.6rem;
                
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="progress-bar">
            <div id="progress" class="progress" style="width: 0%"></div>
        </div>
        <div id="questionContainer" class="question-box"></div>
    </div>

    <script>

        
   // Questions data
const questions = [
    {
        id: 1,
        text: "What is the nature of the infringement?",
        subtext: "Consider how the IP is being used without authorization",
        selectionType: "single",
        options: [
            {
                id: 1,
                text: "Direct commercial use",
                explanation: "The infringer is directly profiting from your IP",
                scores: [1, 5, -2, 0, 2, 3],
                markNotApplicable: [4, 5],
                skipQuestions: [3, 4]
            },
            {
                id: 2,
                text: "Indirect/non-commercial use",
                explanation: "The infringement is not directly generating profit",
                scores: [-2, 2, 4, 1, 0, -1],
                markNotApplicable: [],
                skipQuestions: []
            }
        ]
    },
        {
        id: 2,
        text: "Q2 sklhf efjefj  aekfj ef kf",
        subtext: "oifa leaj fl eh lkh e",
            selectionType: "multiple",
        options: [
            {
                id: 1,
                text: "Direct commercial use",
                explanation: "The infringer is directly profiting from your IP",
                scores: [1, 5, -2, 0, 2, 3],
                markNotApplicable: [4, 5],
                skipQuestions: [3, 4]
            },
            {
                id: 2,
                text: "Indirect/non-commercial use",
                explanation: "The infringement is not directly generating profit",
                scores: [-2, 2, 4, 1, 0, -1],
                markNotApplicable: [],
                skipQuestions: []
            }
        ]
    }
];

// State management
let state = {
    started: false,
    currentQuestion: 0,
    scores: [0, 0, 0, 0, 0, 0],
    notApplicableOptions: new Set(),
    showNotApplicable: false,
    showAllOptions: false
};

function init() {
    const container = document.getElementById('questionContainer');
    if (!state.started) {
        container.innerHTML = `
            <div class="welcome-screen">
                <div class="welcome-content">
                    <h1>My Rights have been infringed</h1>
                    <p class="welcome-text">
                        This tool is designed to help you narrow down and prioritise potential actions based on the information you provide about your situation. At the conclusion, you will receive a shortlist of options for your consideration, empowering you to make an informed decision.
                    </p>
                    <button class="button" onclick="startQuiz()">Begin Assessment</button>
                </div>
            </div>
        `;
    }
}

function startQuiz() {
    state.started = true;
    renderQuestion(state.currentQuestion); // Pass the index
}

function renderQuestion(questionIndex) {
    // Get the actual question object using the index
    const question = questions[questionIndex];
    
    const questionContainer = document.getElementById('questionContainer');
    questionContainer.innerHTML = `
        <h3>${question.text}</h3>
        <p>${question.subtext}</p>
        <div class="options">
            ${question.options.map(option => `
                <div class="option">
                    <input type="${question.selectionType === 'multiple' ? 'checkbox' : 'radio'}" 
                           name="question${question.id}" 
                           value="${option.id}"
                           id="option${option.id}">
                    <label for="option${option.id}">
                        ${option.text}
                        <div class="explanation">${option.explanation}</div>
                    </label>
                </div>
            `).join('')}
        </div>
    `;

    // Add event listeners to the new options
    addSelectionListeners(question.id);
}
        
// function showQuestion(questionIndex) {
//     state.currentQuestion = questionIndex;
//     const question = questions[questionIndex];
//     const container = document.getElementById('questionContainer');
    
//     document.getElementById('progress').style.width = 
//         `${((questionIndex + 1) / questions.length) * 100}%`;
    
//     let html = `
//         <h2>${question.text}</h2>
//         <p class="subtext">${question.subtext}</p>
//     `;
    
//     question.options.forEach((option, index) => {
//         html += `
//             <button 
//                 class="option-button" 
//                 onclick="selectOption(${index})"
//             >${option.text}</button>
//             <div class="explanation">
//                 ${option.explanation}
//             </div>
//         `;
//     });

//     html += `
//         <div class="nav-buttons">
//             <button 
//                 class="nav-button" 
//                 onclick="navigate(-1)" 
//                 ${questionIndex === 0 ? 'disabled' : ''}
//             >Previous</button>
//             <button 
//                 class="nav-button" 
//                 onclick="navigate(1)"
//             >${questionIndex === questions.length - 1 ? 'See Results' : 'Next'}</button>
//         </div>
//     `;
    
//     container.innerHTML = html;
// }
function handleSelection(questionId) {
    const question = questions.find(q => q.id === questionId);
    const selectedInputs = document.querySelectorAll(`input[name="question${questionId}"]:checked`);
    const selectedIds = Array.from(selectedInputs).map(input => parseInt(input.value));

    // Calculate total scores
    const totalScores = Array(6).fill(0); // Assuming scores array is length 6
    const markNotApplicable = new Set();
    const skipQuestions = new Set();

    selectedIds.forEach(optionId => {
        const option = question.options.find(opt => opt.id === optionId);
        if (option) {
            // Add scores
            option.scores.forEach((score, index) => {
                totalScores[index] += score;
            });
            
            // Collect markNotApplicable and skipQuestions
            option.markNotApplicable.forEach(q => markNotApplicable.add(q));
            option.skipQuestions.forEach(q => skipQuestions.add(q));
        }
    });

    // Update your running total/progress here
    updateScores(totalScores);
    handleSkippedQuestions(Array.from(skipQuestions));
    handleNotApplicable(Array.from(markNotApplicable));
}
// function selectOption(optionIndex) {
//     const question = questions[state.currentQuestion];
//     const option = question.options[optionIndex];
    
//     document.querySelectorAll('.option-button').forEach(btn => {
//         btn.classList.remove('selected');
//     });
//     document.querySelectorAll('.explanation').forEach(exp => {
//         exp.style.display = 'none';
//     });
    
//     document.querySelectorAll('.option-button')[optionIndex].classList.add('selected');
//     document.querySelectorAll('.explanation')[optionIndex].style.display = 'block';
    
//     option.scores.forEach((score, index) => {
//         state.scores[index] += score;
//     });

//     if (option.markNotApplicable) {
//         option.markNotApplicable.forEach(optionId => {
//             state.notApplicableOptions.add(optionId);
//         });
//     }
// }

function navigate(direction) {
    const newQuestion = state.currentQuestion + direction;
    if (newQuestion >= 0 && newQuestion < questions.length) {
        showQuestion(newQuestion);
    } else if (newQuestion >= questions.length) {
        showResults();
    }
}
function addSelectionListeners(questionId) {
    const inputs = document.querySelectorAll(`input[name="question${questionId}"]`);
    inputs.forEach(input => {
        input.addEventListener('change', () => handleSelection(questionId));
    });
}
function showResults() {
    const applicableOptions = [
        { 
            id: 1, 
            text: "Send Cease and Desist Letter", 
            score: state.scores[0],
            cost: "free",
            effort: "5-7 hours",
            resolution: "54%",
                                                hidden: false
        },
        { 
            id: 2, 
            text: "File for Preliminary Injunction", 
            score: state.scores[1],
            cost: "$5,000-10,000",
            effort: "20-30 hours",
            resolution: "78%",
                                    hidden: false
        },
        { 
            id: 3,

            text: "Initiate Settlement Discussion", 
            score: state.scores[2],
            cost: "$1,000-3,000",
            effort: "10-15 hours",
            resolution: "65%",
                                    hidden: false
        },
        { 
            id: 4, 
            text: "File a non use request for the TM", 
            score: state.scores[3],
            cost: "$2,000-4,000",
            effort: "8-12 hours",
            resolution: "70%",
                                    hidden: false
        },
        { 
            id: 5, 
            text: "Use Amazon Brand Registry", 
            score: state.scores[4],
            cost: "free",
            effort: "3-5 hours",
            resolution: "85%",
            hidden: false
        },
        { 
            id: 6, 
            text: "Hire a Lawyer immediately", 
            score: state.scores[5],
            cost: "$5,000+",
            effort: "2-3 hours",
            resolution: "90%",
            hidden: false
            
        }
    ]
    .map(opt => ({
        ...opt,
        notApplicable: state.notApplicableOptions.has(opt.id)
    }))
    .sort((a, b) => b.score - a.score);
        const visibleOptions = applicableOptions.filter(opt => !opt.hidden);

const filtered = visibleOptions.filter(opt => !opt.notApplicable);
const naOptions = visibleOptions.filter(opt => opt.notApplicable);

    const container = document.getElementById('questionContainer');
    container.innerHTML = `
        <div class="results-container">
            <h2>Based on your answers, you could consider the following courses of action</h2>
            <p class="results-subtext">It is important to go through all options to determine what's best for you.</p>
            
            <h3 style="color: #30AEB6">Highest-rated suggestions based on your results</h3>
            <p class="option-subtext">You could do one or all of any of these options.</p>
            <div class="results-grid">
                ${filtered.slice(0, 3).map(option => `
                    <div class="result-card">
                        <p class="option-title">${option.text}</p>
                        <div class="option-details">
                            <div class="detail-item">Cost: ${option.cost}</div>
                            <div class="detail-item">Effort: ${option.effort}</div>
                            <div class="detail-item">Rate of resolution: ${option.resolution}</div>
                        </div>
                      <span style="color: #E5E8EC">${option.score}</span>                
                    </div>
                `).join('')}
            </div>

            <h3 style="color: #30AEB6">Other suggestions to consider</h3>
            <div class="results-grid">
                ${filtered.slice(3, 6).map(option => `
                    <div class="result-card">
                        <p class="option-title">${option.text}</p>
                        <div class="option-details">
                            <div class="detail-item">Cost: ${option.cost}</div>
                            <div class="detail-item">Effort: ${option.effort}</div>
                            <div class="detail-item">Rate of resolution: ${option.resolution}</div>
                        </div>
                        <span style="color: #E5E8EC">${option.score}</span>
                    </div>
                `).join('')}
            </div>

            <div class="toggle-buttons">
                <button 
                    class="toggle-button" 
                    onclick="toggleNotApplicable()"
                >
                    ${naOptions.length > 0 ? 
                        `Show ${naOptions.length} Not Applicable Options` : 
                        'No Not Applicable Options'}
                </button>
            </div>

            ${state.showNotApplicable && naOptions.length > 0 ? `
                <div style="margin-top: 20px;">
                    <h3 style="color: #9DA3A8">Not Applicable Options</h3>
                    <div class="results-grid">
                        ${naOptions.map(option => `
                            <div class="result-card not-applicable">
                                <p class="option-title">${option.text}</p>
                                <div class="option-details">
                                    <div class="detail-item">Cost: ${option.cost}</div>
                                    <div class="detail-item">Effort: ${option.effort}</div>
                                    <div class="detail-item">Rate of resolution: ${option.resolution}</div>
                                </div>
                                <span style="color: #E5E8EC">${option.score}</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            ` : ''}
        </div>
    `;
}

function toggleNotApplicable() {
    state.showNotApplicable = !state.showNotApplicable;
    showResults();
}

// Start the application
init();
          </script>
</body>
</html>
